<html>
	<!-- Manual inspection of visualizer renderer output -->
	<head>
		<script src=../../thirdparty/jquery.js></script>		
                <script src=../../thirdparty/jquery.easing.1.3.js></script>                
                <script src=../../thirdparty/Three.js></script>                

                <script src=../../src/utils.js></script>
                <script src=../../src/rhythmanalysis.js></script>
                <script src=../../src/timeliner.js></script>
                <script src=../../src/timelinevisualizer.js></script>
                <script src=../../src/showobjects.js></script>
                <script src=../../src/show.js></script>
                <script src=../../src/loader.js></script>
                <script src=../../src/renderers/three.js></script>
                <script src=../../src/effects/base.js></script>
                <script src=../../src/effects/linear.js></script>
                 
                <script src=../../testdata/simple-plan.js></script>
                <script src=../../testdata/sample-song-data.js></script>

                <link href=../../media/visualizer.css rel=stylesheet></link>
		
                <script type="text/javascript">
                	$(document).ready(function() {
				
				
				function setupVisualizer(visualizer) {
                                        visualizer.secondsPerPixel = 0.02;
                                        visualizer.lineLength = 2000;				        
				}
				
				// Visualization without music
			        var timeliner = krusovice.Timeliner.createSimpleTimeliner(simpleElements, null);
			        var plan = timeliner.createPlan();			        
			        var visualizer = new krusovice.TimelineVisualizer({plan:plan});			        
			        var div = document.getElementById("visualizer-no-rhythm");	
			        setupVisualizer(visualizer);		        
			        visualizer.render(div);					

                                // Visualization with music
                                if(!sampleSongData) {
                                        throw "No music";
                                }
                                var timeliner = krusovice.Timeliner.createSimpleTimeliner(simpleElements, sampleSongData);
                                var plan = timeliner.createPlan();                              
                                
                                var visualizer = new krusovice.TimelineVisualizer({plan:plan, rhythmData:sampleSongData});                                
                                var div = document.getElementById("visualizer-rhythm");                               
                                setupVisualizer(visualizer);                                
                                visualizer.render(div);          
                                
                                var songURL = "../../testdata/sample-song.mp3";
                                var player = new krusovice.TimelinePlayer(visualizer, songURL);
                                $("#player").append(player.audio);      
                                
                                
                                var cfg = {
                                        rhythmData : sampleSongData,
                                        songURL : "../../testdata/sample-song.mp3",
                                        timeline : plan,
                                        backgroundType : "plain",
                                        plainColor : "#ffffff",
                                        controls : false,
                                        elem : $("#show")                                                                                
                                };
                                
                                var show = new krusovice.Show(cfg);
                                show.bindToAudio(player.audio);   
                                
                                krusovice.attachSimpleLoadingNote(show);                                                                                                                                
                                show.prepare();
                                                                                        
			});
                </script>		
       	</head>
	
	<body>
		<h1>No rhythm</h1>
		<div id="visualizer-no-rhythm">
			
		</div>

                <div id=show></div>

                <h1>Rhythm</h1>
                <div id="player"></div>
                <div id="visualizer-rhythm">
                        
                </div>

		
	</body>
</html>